<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Differential Equations · SciMLMiniCourse.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://stephans3.github.io/SciMLMiniCourse.jl/basics_sciml/diff_eq/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SciMLMiniCourse.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Julia programming</span><ul><li><a class="tocitem" href="../../intro_programming/intro_julia/">Quick introduction</a></li><li><a class="tocitem" href="../../intro_programming/arrays_loops/">Arrays and Loops</a></li><li><a class="tocitem" href="../../intro_programming/num_integration_diff/">Numerical integration and differentiation</a></li><li><a class="tocitem" href="../../intro_programming/finite_diff_2d/">Finite differences in 2 dimensions</a></li></ul></li><li><span class="tocitem">Basics of Scientific Machine Learning</span><ul><li class="is-active"><a class="tocitem" href>Differential Equations</a><ul class="internal"><li><a class="tocitem" href="#About-ODEs"><span>About ODEs</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li></ul></li><li><a class="tocitem" href="../homework_1/">Homework: Differential Equations</a></li><li><a class="tocitem" href="../art_neural_networks/">Artificial Neural Networks</a></li><li><a class="tocitem" href="../neural_ode/">Neural Ordinary Differential Equations</a></li><li><a class="tocitem" href="../homework_2/">Homework: Machine Learning</a></li></ul></li><li><a class="tocitem" href="../../projects/">Projects</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics of Scientific Machine Learning</a></li><li class="is-active"><a href>Differential Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Differential Equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/stephans3/SciMLMiniCourse.jl/blob/main/docs/src/basics_sciml/diff_eq.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-Equations"><a class="docs-heading-anchor" href="#Differential-Equations">Differential Equations</a><a id="Differential-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Equations" title="Permalink"></a></h1><p>Differential Equations are mathematical structures which can be used to model physical, biological, chemical, economical/financial and social models. </p><h4 id="[Ordinary-Differential-Equations-(ODE)](https://en.wikipedia.org/wiki/Ordinary_differential_equation)"><a class="docs-heading-anchor" href="#[Ordinary-Differential-Equations-(ODE)](https://en.wikipedia.org/wiki/Ordinary_differential_equation)"><a href="https://en.wikipedia.org/wiki/Ordinary_differential_equation">Ordinary Differential Equations (ODE)</a></a><a id="[Ordinary-Differential-Equations-(ODE)](https://en.wikipedia.org/wiki/Ordinary_differential_equation)-1"></a><a class="docs-heading-anchor-permalink" href="#[Ordinary-Differential-Equations-(ODE)](https://en.wikipedia.org/wiki/Ordinary_differential_equation)" title="Permalink"></a></h4><p><em>Van der Pol oscillator</em></p><p class="math-container">\[\ddot{y}(t) - \mu (1 - y(t)^2) \dot{y}(t) + y(t) = 0\]</p><h4 id="[Differential-Algebraic-Equation-(DAE)](https://en.wikipedia.org/wiki/Differential-algebraic_system_of_equations)"><a class="docs-heading-anchor" href="#[Differential-Algebraic-Equation-(DAE)](https://en.wikipedia.org/wiki/Differential-algebraic_system_of_equations)"><a href="https://en.wikipedia.org/wiki/Differential-algebraic_system_of_equations">Differential-Algebraic Equation (DAE)</a></a><a id="[Differential-Algebraic-Equation-(DAE)](https://en.wikipedia.org/wiki/Differential-algebraic_system_of_equations)-1"></a><a class="docs-heading-anchor-permalink" href="#[Differential-Algebraic-Equation-(DAE)](https://en.wikipedia.org/wiki/Differential-algebraic_system_of_equations)" title="Permalink"></a></h4><p class="math-container">\[\begin{matrix}
\dot{x}(t) = &amp; -2x(t) + 3y(t) \\
\dot{y}(t) = &amp; -3x(t) \\
0 = &amp; x(t) + y(t)
\end{matrix}\]</p><p>Applications e.g. in Robotics (multibody dynamics) and Electrical Engineering (circuit modeling).</p><h4 id="[Stochastic-Differential-Equation-(SDE)](https://en.wikipedia.org/wiki/Stochastic_differential_equation)"><a class="docs-heading-anchor" href="#[Stochastic-Differential-Equation-(SDE)](https://en.wikipedia.org/wiki/Stochastic_differential_equation)"><a href="https://en.wikipedia.org/wiki/Stochastic_differential_equation">Stochastic Differential Equation (SDE)</a></a><a id="[Stochastic-Differential-Equation-(SDE)](https://en.wikipedia.org/wiki/Stochastic_differential_equation)-1"></a><a class="docs-heading-anchor-permalink" href="#[Stochastic-Differential-Equation-(SDE)](https://en.wikipedia.org/wiki/Stochastic_differential_equation)" title="Permalink"></a></h4><p><em>Langevin equation</em></p><p class="math-container">\[m \frac{d v(t)}{dt} = - \lambda v(t) + \eta(t)\]</p><p>with noise term <span>$\eta(t)$</span></p><p>Applications e.g. in biology. </p><h4 id="[Partial-Differential-Equation-(PDE)](https://en.wikipedia.org/wiki/Partial_differential_equation)"><a class="docs-heading-anchor" href="#[Partial-Differential-Equation-(PDE)](https://en.wikipedia.org/wiki/Partial_differential_equation)"><a href="https://en.wikipedia.org/wiki/Partial_differential_equation">Partial Differential Equation (PDE)</a></a><a id="[Partial-Differential-Equation-(PDE)](https://en.wikipedia.org/wiki/Partial_differential_equation)-1"></a><a class="docs-heading-anchor-permalink" href="#[Partial-Differential-Equation-(PDE)](https://en.wikipedia.org/wiki/Partial_differential_equation)" title="Permalink"></a></h4><p><em>Heat Equation</em> </p><p class="math-container">\[\frac{\partial y(t,x)}{\partial t} = \alpha \frac{\partial^2 y(t,x)}{\partial x^2}\]</p><p>Applications in continuum mechanics (Navier-Stokes equations), electromagnetism (Maxwell–Heaviside equations), etc. </p><h4 id="Mixtures-and-other-types"><a class="docs-heading-anchor" href="#Mixtures-and-other-types">Mixtures and other types</a><a id="Mixtures-and-other-types-1"></a><a class="docs-heading-anchor-permalink" href="#Mixtures-and-other-types" title="Permalink"></a></h4><ul><li><a href="https://en.wikipedia.org/wiki/Stochastic_partial_differential_equation">Stochastic PDE</a></li><li><a href="https://en.wikipedia.org/wiki/Partial_differential_algebraic_equation">Partial-Differential-Algebraic Equations</a> </li><li><a href="https://en.wikipedia.org/wiki/Integro-differential_equation">Integro-differential equations</a></li><li><a href="https://en.wikipedia.org/wiki/Delay_differential_equation">Delay differential equations</a></li></ul><h2 id="About-ODEs"><a class="docs-heading-anchor" href="#About-ODEs">About ODEs</a><a id="About-ODEs-1"></a><a class="docs-heading-anchor-permalink" href="#About-ODEs" title="Permalink"></a></h2><p>In this course we will focus on ODEs. Nevertheless, the existing SciML methods can also be used for other types of differential equations. As a first step in the study of an ODE we distinguish between linear and nonlinear equations. Many easy concepts from linear algebra exist to investigate <a href="https://en.wikipedia.org/wiki/Linear_differential_equation">linear ODEs</a>. These concepts can not (or only up to some limit) be applied on nonlinear ODE and so we have to use methods from systems theory (<a href="https://en.wikipedia.org/wiki/Lyapunov_stability">Lyapunov stability</a>) or differential geometry like Lie derivatives, differential flatness, etc.</p><p>If we study a linear ODE <span>$\dot{x}(t) = A ~ x(t)$</span> we can determine the behaviour of its <span>$x(t)$</span> for <span>$t \rightarrow \infty$</span> via its stability (in the sense of Lyapunov). If (and only iff) all Eigenvalues of system matrix <span>$A$</span> smaller than zero (negative) then we call call the ODE stable and we know that all states approaching zero at <span>$t \rightarrow \infty$</span></p><h4 id="Example:-Linear-ODE"><a class="docs-heading-anchor" href="#Example:-Linear-ODE">Example: Linear ODE</a><a id="Example:-Linear-ODE-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Linear-ODE" title="Permalink"></a></h4><p>The ordinary differential equation</p><p class="math-container">\[\begin{pmatrix}
\dot{x}_{1}(t) \\
\dot{x}_{2}(t)
\end{pmatrix} =
\begin{pmatrix}
-2 &amp; ~1 \\
~3 &amp; -4 
\end{pmatrix}
\begin{pmatrix}
x_{1}(t) \\
x_{2}(t)
\end{pmatrix}\]</p><p>has the Eigenvalues <span>$\lambda \in \{-1, -5\}$</span>. So the ODE is stable and all states reach for arbitrary initial values <span>$x_{0}$</span> the origin <span>$(0,0)$</span>.</p><p>In Julia we can prove this with method <code>eigvals()</code> from the standard library <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra.jl</a>.</p><pre><code class="language-julia hljs">A = [-2 1; 3 -4];

using LinearAlgebra
evals = eigvals(A)</code></pre><p>The true solution of this ODE is <span>$x(t)=\exp(A~t) ~ x_{0}$</span> </p><h4 id="Euler-method"><a class="docs-heading-anchor" href="#Euler-method">Euler method</a><a id="Euler-method-1"></a><a class="docs-heading-anchor-permalink" href="#Euler-method" title="Permalink"></a></h4><p>The differential equation <span>$\dot{x}(t)=A~x(t)$</span> can also be solved numerically. The forward Euler method is one of the easiest numerical integration methods. It is briefly described by</p><p class="math-container">\[\dot{x}(t) \approx \frac{x(n+1) - x(n)}{\Delta T} = A ~ x(n)\]</p><p>and can be rearranged as</p><p class="math-container">\[x(n+1) = x(n) + \Delta T ~ A~x(n) = (I + \Delta T ~ A) ~ x(n)\]</p><p>with identity matrix <span>$I$</span>. The sampling time <span>$\Delta T&gt;0$</span> has to be chosen such that all Eigenvalues of matrix <span>$A_{d} = I + \Delta T ~ A$</span> are inside the unit circle. So, we guarantee a <a href="https://en.wikipedia.org/wiki/Stiff_equation#A-stability">stable numerical integration; see also: A-Stability</a>.</p><pre><code class="language-julia hljs">Tf = 10.0;  # Final simulation time
ΔT = 0.25;  # Sampling time
N  = round(Int, Tf/ΔT + 1); # Number of sampling points
x = zeros(2, N)       # Solution of Euler method
x[:,1] = x0           # Set initial value

for i in range(1,N-1)
    x[:,i+1] = x[:,i] + ΔT * A*x[:,i] # Euler method: x(n+1)=x(n)+ΔT*A*x(n)
end</code></pre><h4 id="Runge-Kutta-methods-via-DifferentialEquations.jl"><a class="docs-heading-anchor" href="#Runge-Kutta-methods-via-DifferentialEquations.jl">Runge-Kutta methods via DifferentialEquations.jl</a><a id="Runge-Kutta-methods-via-DifferentialEquations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Runge-Kutta-methods-via-DifferentialEquations.jl" title="Permalink"></a></h4><p>The Euler method has a very weak performance and is rather used for tests. In contrast, n-th order <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">Runge-Kutta methods</a> provide much more better integration tools. A lot of integration methods is already implemented in <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>. A list of all integration methods <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/">can be found in section &quot;ODE Solvers&quot;</a>. </p><p><strong>I recommend to read the <a href="https://diffeq.sciml.ai/stable/tutorials/ode_example/">tutorial about Ordinary Differential Equations</a>.</strong></p><pre><code class="language-julia hljs">using DifferentialEquations
linear_ode(x,p,t) = A * x   # Right-hand side of ODE x&#39;(t)=A x(t)
tspan = (0.,Tf)             # Time span 
alg   = Tsit5()             # Runge-Kutta integration method
prob  = ODEProblem(linear_ode, x0, tspan)
sol   = solve(prob, alg, saveat=ΔT)    # Solution of numerical integration</code></pre><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><p>One main questions of this course is how to compute system parameters. We know for many processes the system dynamics which is described by parameters. However, quite often we do not know the certain parameters. In case of a spring mass system we derive the ODE as</p><p class="math-container">\[m \ddot{x}(t) + k x(t) = u(t)\]</p><p>or equivalent </p><p class="math-container">\[\ddot{x}(t) = -\frac{k}{m} x(t) + u(t) = -p ~ x(t) + u(t)\]</p><p>with mass <span>$m&gt;0$</span> and spring constant <span>$k&gt;0$</span> as parameters and <span>$u(t)$</span> as external force (or input signal). Both parameters are united as <span>$p=\frac{k}{m}$</span>. We assume the input <span>$u(t)=sin(t)$</span> and develop the right-hand side of this ODE.</p><pre><code class="language-julia hljs">function mass_spring(dx, x, p, t)
    u = sin(t)   # external force / input signal
    
    dx[1] = x[2]                # dx1/dt = x2
    dx[2] = -p[1] * x[1] + u    # dx2/dt = -p * x2 + u
end</code></pre><p>The time span, initial values <span>$x_0 = (0,0)^{\top}$</span> and the parameter <span>$p=\frac{k}{m}=2$</span> have to be defined.</p><pre><code class="language-julia hljs">param = [2.0]       # Parameter p = k/m with k=spring constant, m=mass
x0    = [0.0, 0.0]  # Initial values
tspan = (0.,30.)    # Time span </code></pre><p>The parameter can be handed over to the solver in <code>ODEProblem(...,p=param)</code> or in <code>solve(,p=param)</code>. I recommend to use <code>solve(,p=param)</code> because in the Machine Learning part we will build the ODEProblem once and use <code>solve</code> repeatedly.</p><pre><code class="language-julia hljs">using DifferentialEquations
alg   = Tsit5()             # Runge-Kutta integration method
prob  = ODEProblem(mass_spring, x0, tspan)
sol   = solve(prob, alg, p=param)    # Numerical integration with parameter</code></pre><p>See also: (Defining Parametrized Functions)[https://diffeq.sciml.ai/stable/tutorials/ode_example/#Defining-Parameterized-Functions] in the DifferentialEquations docs.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../intro_programming/finite_diff_2d/">« Finite differences in 2 dimensions</a><a class="docs-footer-nextpage" href="../homework_1/">Homework: Differential Equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 14 October 2022 08:33">Friday 14 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
